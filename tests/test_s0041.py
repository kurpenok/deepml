import numpy as np

from solutions.s0041_simple_convolutional_2d_layer import simple_conv2d


def test_case_1():
    assert (
        simple_conv2d(
            np.array(
                [
                    [1.0, 2.0, 3.0, 4.0],
                    [5.0, 6.0, 7.0, 8.0],
                    [9.0, 10.0, 11.0, 12.0],
                    [13.0, 14.0, 15.0, 16.0],
                ]
            ),
            np.array([[1.0, 0.0], [-1.0, 1.0]]),
            1,
            2,
        )
        == np.array([[1.0, 1.0, -4.0], [9.0, 7.0, -4.0], [0.0, 14.0, 16.0]])
    ).all()


def test_case_2():
    assert (
        simple_conv2d(
            np.array(
                [
                    [1.0, 2.0, 3.0, 4.0, 5.0],
                    [6.0, 7.0, 8.0, 9.0, 10.0],
                    [11.0, 12.0, 13.0, 14.0, 15.0],
                    [16.0, 17.0, 18.0, 19.0, 20.0],
                    [21.0, 22.0, 23.0, 24.0, 25.0],
                ]
            ),
            np.array(
                [
                    [1.0, 2.0],
                    [3.0, -1.0],
                ]
            ),
            0,
            1,
        )
        == np.array(
            [
                [16.0, 21.0, 26.0, 31.0],
                [41.0, 46.0, 51.0, 56.0],
                [66.0, 71.0, 76.0, 81.0],
                [91.0, 96.0, 101.0, 106.0],
            ]
        )
    ).all()


def test_case_3():
    assert (
        simple_conv2d(
            np.array(
                [
                    [1.0, 2.0, 3.0, 4.0, 5.0],
                    [6.0, 7.0, 8.0, 9.0, 10.0],
                    [11.0, 12.0, 13.0, 14.0, 15.0],
                    [16.0, 17.0, 18.0, 19.0, 20.0],
                    [21.0, 22.0, 23.0, 24.0, 25.0],
                ]
            ),
            np.array(
                [
                    [0.5, 3.2],
                    [1.0, -1.0],
                ]
            ),
            2,
            2,
        )
        == np.array(
            [
                [0.0, 0.0, 0.0, 0.0],
                [0.0, 5.9, 13.3, 12.5],
                [0.0, 42.9, 50.3, 27.5],
                [0.0, 80.9, 88.3, 12.5],
            ]
        )
    ).all()
