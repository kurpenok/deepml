import numpy as np

from solutions.s0085_positional_encoding_calculator import pos_encoding


def test_case_1():
    assert np.allclose(
        pos_encoding(5, 16),
        np.array(
            [
                [
                    0.000e00,
                    1.000e00,
                    0.000e00,
                    1.000e00,
                    0.000e00,
                    1.000e00,
                    0.000e00,
                    1.000e00,
                    0.000e00,
                    1.000e00,
                    0.000e00,
                    1.000e00,
                    0.000e00,
                    1.000e00,
                    0.000e00,
                    1.000e00,
                ],
                [
                    8.413e-01,
                    5.405e-01,
                    3.110e-01,
                    9.502e-01,
                    9.985e-02,
                    9.951e-01,
                    3.162e-02,
                    9.995e-01,
                    1.000e-02,
                    1.000e00,
                    3.162e-03,
                    1.000e00,
                    1.000e-03,
                    1.000e00,
                    3.161e-04,
                    1.000e00,
                ],
                [
                    9.092e-01,
                    -4.163e-01,
                    5.913e-01,
                    8.066e-01,
                    1.986e-01,
                    9.800e-01,
                    6.323e-02,
                    9.980e-01,
                    2.000e-02,
                    1.000e00,
                    6.325e-03,
                    1.000e00,
                    2.001e-03,
                    1.000e00,
                    6.323e-04,
                    1.000e00,
                ],
                [
                    1.411e-01,
                    -9.902e-01,
                    8.125e-01,
                    5.825e-01,
                    2.954e-01,
                    9.556e-01,
                    9.473e-02,
                    9.956e-01,
                    3.000e-02,
                    9.995e-01,
                    9.483e-03,
                    1.000e00,
                    3.000e-03,
                    1.000e00,
                    9.489e-04,
                    1.000e00,
                ],
                [
                    -7.568e-01,
                    -6.538e-01,
                    9.536e-01,
                    3.010e-01,
                    3.894e-01,
                    9.209e-01,
                    1.261e-01,
                    9.922e-01,
                    3.998e-02,
                    9.990e-01,
                    1.265e-02,
                    1.000e00,
                    4.002e-03,
                    1.000e00,
                    1.265e-03,
                    1.000e00,
                ],
            ]
        ),
        atol=1e-4,
    )
